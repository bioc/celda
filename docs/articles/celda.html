<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of single-cell genomic data with celda • celda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of single-cell genomic data with celda">
<meta property="og:description" content="celda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.14.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.camplab.net/celda" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/campbio/celda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="celda_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of single-cell genomic data with celda</h1>
                        <h4 data-toc-skip class="author">Joshua Campbell</h4>
            <address class="author_afil">
      Boston University School of Medicine<br><a class="author_email" href="mailto:#"></a><a href="mailto:camp@bu.edu" class="email">camp@bu.edu</a>
      </address>
                              <h4 data-toc-skip class="author">Zhe Wang</h4>
            <address class="author_afil">
      Boston University School of Medicine<br><h4 data-toc-skip class="author">Shiyi Yang</h4>
            <address class="author_afil">
      Boston University School of Medicine<br><h4 data-toc-skip class="author">Sean Corbett</h4>
            <address class="author_afil">
      Boston University School of Medicine<br><h4 data-toc-skip class="author">Yusuke Koga</h4>
            <address class="author_afil">
      Boston University School of Medicine<br><h4 data-toc-skip class="date">2023-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/campbio/celda/blob/HEAD/vignettes/celda.Rmd" class="external-link"><code>vignettes/celda.Rmd</code></a></small>
      <div class="hidden name"><code>celda.Rmd</code></div>

    </address>
</address>
</address>
</address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>CE</strong>llular <strong>L</strong>atent <strong>D</strong>irichlet <strong>A</strong>llocation (celda) is a collection of Bayesian hierarchical models to perform feature and cell bi-clustering for count data generated by single-cell platforms. This algorithm is an extension of the Latent Dirichlet Allocation (LDA) topic modeling framework that has been popular in text mining applications and has shown good performance with sparse data. celda simultaneously clusters features (i.e. gene expression) into modules based on co-expression patterns across cells and cells into subpopulations based on the probabilities of the feature modules within each cell.</p>
<p>Starting from Bioconductor release 3.12 (<code>celda</code> version 1.6.0), <code>celda</code> makes use of <em><a href="https://bioconductor.org/packages/3.16/SingleCellExperiment" class="external-link">SingleCellExperiment</a></em> (SCE) objects for storing data and results. In this vignette we will demonstrate how to use celda to perform cell and feature clustering with a simple, small simulated dataset. This vignette does not include upstream importing of data, quality control, or filtering. To see a more complete analysis of larger real-world datasets, visit <a href="https://www.camplab.net/celda/" class="external-link">camplab.net/celda</a> for additional vignettes.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>celda can be installed from Bioconductor:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"celda"</span><span class="op">)</span></span></code></pre></div>
<p>To load the package, type the following:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">celda</span><span class="op">)</span></span></code></pre></div>
<p>A complete list of help files are accessible using the help command with the <code>package</code> option.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span>package <span class="op">=</span> <span class="va">celda</span><span class="op">)</span></span></code></pre></div>
<p>To see the latest updates and releases or to post a bug, see our GitHub page at <a href="https://github.com/campbio/celda" class="external-link uri">https://github.com/campbio/celda</a>. To ask questions about running celda, post a thread on Bioconductor support site at <a href="https://support.bioconductor.org/" class="external-link uri">https://support.bioconductor.org/</a>.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="generation-of-a-simulated-single-cell-dataset">Generation of a simulated single cell dataset<a class="anchor" aria-label="anchor" href="#generation-of-a-simulated-single-cell-dataset"></a>
</h2>
<p>celda will take a matrix of counts where each row is a feature, each column is a cell, and each entry in the matrix is the number of counts of each feature in each cell. To illustrate the utility of celda, we will apply it to a simulated dataset.</p>
<p>In the function <code>simulateCells</code>, the <strong>K</strong> parameter designates the number of cell clusters, the <strong>L</strong> parameter determines the number of feature modules, the <strong>S</strong> parameter determines the number of samples in the simulated dataset, the <strong>G</strong> parameter determines the number of features to be simulated, and <strong>CRange</strong> specifies the lower and upper bounds of the number of cells to be generated in each sample.</p>
<p>To simulate a dataset of 5 samples with 5 cell populations, 10 feature modules, 200 features, and between 30 to 50 cells per sample using <code>celda_CG</code> model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simsce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateCells.html">simulateCells</a></span><span class="op">(</span><span class="st">"celda_CG"</span>,</span>
<span>    S <span class="op">=</span> <span class="fl">5</span>, K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span>, G <span class="op">=</span> <span class="fl">200</span>, CRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>counts</code> assay slot in <code>simsce</code> contains the counts matrix. The dimensions of counts matrix:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 200 207</span></span></code></pre>
<p>Columns <code>celda_sample_label</code> and <code>celda_cell_cluster</code> in <code>colData(simsce)</code> contain sample labels and celda cell population cluster labels. Here are the numbers of cells in each subpopulation and in each sample:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">$</span><span class="va">celda_cell_cluster</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  1  2  3  4  5 </span></span>
<span><span class="co">## 42 44 40 47 34</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">$</span><span class="va">celda_sample_label</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Sample_1 Sample_2 Sample_3 Sample_4 Sample_5 </span></span>
<span><span class="co">##       43       48       45       40       31</span></span></code></pre>
<p>Column <code>celda_feature_module</code> in <code>rowData(simsce)</code> contains feature module labels. Here is the number of features in each feature module:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">$</span><span class="va">celda_feature_module</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  1  2  3  4  5  6  7  8  9 10 </span></span>
<span><span class="co">## 23 39 17 15 21 22 19 12  4 28</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="feature-selection">Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection"></a>
</h2>
<p>A simple heuristic feature selection is performed to reduce the size of features used for clustering. To speed up the process, only features with at least 3 counts in at least 3 cells are included in downstream clustering for this data. A subset <code>SingleCellExperiment</code> object with filtered features is stored in <code>altExp(simsce, "featureSubset")</code> slot by default.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simsce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectFeatures.html">selectFeatures</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span></span></code></pre></div>
<p>If the number of features is still too large, then a smaller subset of features can be obtained by selecting the top number of most variable genes. For an example code, see the PBMC3K tutorial in the online celda <a href="https://www.camplab.net/celda" class="external-link">documentation</a>.</p>
</div>
<div class="section level2">
<h2 id="performing-bi-clustering-with-celda">Performing bi-clustering with celda<a class="anchor" aria-label="anchor" href="#performing-bi-clustering-with-celda"></a>
</h2>
<p>There are currently three models within <em>celda</em> package: <code>celda_C</code> will cluster cells, <code>celda_G</code> will cluster features, and <code>celda_CG</code> will simultaneously cluster cells and features. Within the functions the <code>K</code> parameter will be the number of cell populations to be estimated, while the <code>L</code> parameter will be the number of feature modules to be estimated in the output model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/celda_CG.html">celda_CG</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">simsce</span>, K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, nchains <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Here is a comparison between the true cluster labels and the estimated cluster labels.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="fu"><a href="../reference/celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##      1  2  3  4  5</span></span>
<span><span class="co">##   1  0 44  0  0  0</span></span>
<span><span class="co">##   2 42  0  0  0  0</span></span>
<span><span class="co">##   3  0  0 40  0  0</span></span>
<span><span class="co">##   4  0  0  0 47  0</span></span>
<span><span class="co">##   5  0  0  0  0 34</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/celdaModules.html">celdaModules</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="fu"><a href="../reference/celdaModules.html">celdaModules</a></span><span class="op">(</span><span class="va">simsce</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     </span></span>
<span><span class="co">##       1  2  3  4  5  6  7  8  9 10</span></span>
<span><span class="co">##   1   0 32  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   2  19  0  0  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   3   0  0 15  0  0  0  0  0  0  0</span></span>
<span><span class="co">##   4   0  0  0 13  0  0  0  0  0  0</span></span>
<span><span class="co">##   5   0  0  0  0 21  0  0  0  0  0</span></span>
<span><span class="co">##   6   0  0  0  0  0 19  0  0  0  0</span></span>
<span><span class="co">##   7   0  0  0  0  0  0  0 12  0  0</span></span>
<span><span class="co">##   8   0  0  0  0  0  0 17  0  0  0</span></span>
<span><span class="co">##   9   0  0  0  0  0  0  0  0  3  0</span></span>
<span><span class="co">##   10  0  0  0  0  0  0  0  0  0 20</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="section level3">
<h3 id="plotting-cell-populations-on-2d-embeddings">Plotting cell populations on 2D-embeddings<a class="anchor" aria-label="anchor" href="#plotting-cell-populations-on-2d-embeddings"></a>
</h3>
<p>celda contains its own wrapper function for tSNE and UMAP called <code>celdaTsne</code> and <code>celdaUmap</code>, respectively. Both of these functions can be used to embed cells into 2-dimensions. The output can be used in the downstream plotting functions <code>plotDimReduceCluster</code>, <code>plotDimReduceModule</code>, and <code>plotDimReduceFeature</code> to show cell population clusters, module probabilities, and expression of individual features, respectively.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/celdaUmap.html">celdaUmap</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDimReduceCluster.html">plotDimReduceCluster</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sce</span>, reducedDimName <span class="op">=</span> <span class="st">"celda_UMAP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/plot_umap-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDimReduceModule.html">plotDimReduceModule</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sce</span>, reducedDimName <span class="op">=</span> <span class="st">"celda_UMAP"</span>, rescale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/plot_umap-2.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDimReduceFeature.html">plotDimReduceFeature</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sce</span>, reducedDimName <span class="op">=</span> <span class="st">"celda_UMAP"</span>,</span>
<span>    normalize <span class="op">=</span> <span class="cn">TRUE</span>, features <span class="op">=</span> <span class="st">"Gene_1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/plot_umap-3.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="creating-an-expression-heatmap">Creating an expression heatmap<a class="anchor" aria-label="anchor" href="#creating-an-expression-heatmap"></a>
</h3>
<p>The clustering results can be viewed with a heatmap of the normalized counts using the function <code>celdaHeatmap</code>. The top <code>nfeatures</code> in each module will be selected according to the factorized module probability matrix.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/celdaHeatmap.html">celdaHeatmap</a></span><span class="op">(</span>sce <span class="op">=</span> <span class="va">sce</span>, nfeatures <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/celda_heatmap-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="displaying-relationships-between-modules-and-cell-populations">Displaying relationships between modules and cell populations<a class="anchor" aria-label="anchor" href="#displaying-relationships-between-modules-and-cell-populations"></a>
</h3>
<p>The relationships between feature modules and cell populations can be visualized with <code>celdaProbabilityMap</code>. The absolute probabilities of each feature module in each cellular subpopulation is shown on the left. The normalized and z-scored expression of each module in each cell population is shown on the right.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/celdaProbabilityMap.html">celdaProbabilityMap</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/propmap-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="examining-co-expression-with-module-heatmaps">Examining co-expression with module heatmaps<a class="anchor" aria-label="anchor" href="#examining-co-expression-with-module-heatmaps"></a>
</h3>
<p><code>moduleHeatmap</code> creates a heatmap using only the features from a specific feature module. Cells are ordered from those with the lowest probability of the module to the highest. If more than one module is used, then cells will be ordered by the probabilities of the first module.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/moduleHeatmap.html">moduleHeatmap</a></span><span class="op">(</span><span class="va">sce</span>, featureModule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, topCells <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/module_heatmap-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="identifying-reasonable-numbers-of-feature-modules-and-cell-subpopulations">Identifying reasonable numbers of feature modules and cell subpopulations<a class="anchor" aria-label="anchor" href="#identifying-reasonable-numbers-of-feature-modules-and-cell-subpopulations"></a>
</h2>
<p>In the previous example, the best <code>K</code> (the number of cell clusters) and <code>L</code> (the number of feature modules) was already known. However, the optimal <code>K</code> and <code>L</code> for each new dataset will likely not be known beforehand and multiple choices of <code>K</code> and <code>L</code> may need to be tried and compared. celda offers two sets of functions to determine the optimum <code>K</code> and <code>L</code>, <code>recursiveSplitModule</code>/<code>recursiveSplitCell</code>, and <code>celdaGridSearch</code>.</p>
<div class="section level3">
<h3 id="using-recursive-splitting">Using recursive splitting<a class="anchor" aria-label="anchor" href="#using-recursive-splitting"></a>
</h3>
<p>Functions <code>recursiveSplitModule</code> and <code>recursiveSplitCell</code> offer a fast method to generate a celda model with optimum <code>K</code> and <code>L</code>. First, <code>recursiveSplitModule</code> is used to determine the optimal <code>L</code>. <code>recursiveSplitModule</code> first splits features into however many modules are specified in <code>initialL</code>. The module labels are then recursively split in a way that would generate the highest log-likelihood, all the way up to <code>maxL</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moduleSplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recursiveSplitModule.html">recursiveSplitModule</a></span><span class="op">(</span><span class="va">simsce</span>, initialL <span class="op">=</span> <span class="fl">2</span>, maxL <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Perplexity is a statistical measure of how well a probability model can predict new data. Lower perplexity indicates a better model. The perplexity of each model can be visualized with <code>plotGridSearchPerplexity</code>. In general, visual inspection of the plot can be used to select the optimal number of modules (<code>L</code>) or cell populations (<code>K</code>) by identifying the “elbow” - where the rate of decrease in the perplexity starts to drop off.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">moduleSplit</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>In this example, the perplexity for <code>L</code> stops decreasing at L = 10, thus L = 10 would be a good choice. Sometimes the perplexity alone does not show a clear elbow or “leveling off”. However, the rate of perplexity change (RPC) can be more informative to determine when adding new modules does not add much additional information <a href="https://doi.org/10.1186/1471-2105-16-S13-S8" target="_blank" class="external-link">Zhao et al., 2015</a>). An RPC closer to zero indicates that the addition of new modules or cell clusters is not substantially decreasing the perplexity. The RPC of models can be visualized using function <code>plotRPC</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRPC.html">plotRPC</a></span><span class="op">(</span><span class="va">moduleSplit</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/module_split_rpc-1.png" width="700"></p>
<p>Once you have identified the optimal <code>L</code> (in this case, L is selected to be 10), the module labels are used for initialization in <code>recursiveSplitCell</code>. Similarly to <code>recursiveSplitModule</code>, cells are initially split into a small number of subpopulations, and the subpopulations are recursively split up.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moduleSplitSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">moduleSplit</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cellSplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recursiveSplitCell.html">recursiveSplitCell</a></span><span class="op">(</span><span class="va">moduleSplitSelect</span>,</span>
<span>    initialK <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    maxK <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    yInit <span class="op">=</span> <span class="fu"><a href="../reference/celdaModules.html">celdaModules</a></span><span class="op">(</span><span class="va">moduleSplitSelect</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">cellSplit</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/rpc_cell-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRPC.html">plotRPC</a></span><span class="op">(</span><span class="va">cellSplit</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/rpc_cell-2.png" width="700"></p>
<p>In this plot, the perplexity for K stops decreasing at K = 5, with a final K/L combination of K = 5, L = 10. Generally, this method can be used to pick a reasonable <code>L</code> and a potential range of <code>K</code>. However, manual review of specific selections of <code>K</code> is often required to ensure results are biologically coherent.</p>
<p>Once users have chosen the K/L parameters for further analysis, the <code>subsetCeldaList</code> function can be used to subset the celda list <em>SCE</em> object to a single model <em>SCE</em> object.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">cellSplit</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-a-grid-search">Using a grid search<a class="anchor" aria-label="anchor" href="#using-a-grid-search"></a>
</h3>
<p>Alternativley to recursive splitting, celda is able to run multiple combinations of K and L with multiple chains in parallel via the <code>celdaGridSearch</code> function.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/celdaGridSearch.html">celdaGridSearch</a></span><span class="op">(</span><span class="va">simsce</span>,</span>
<span>    paramsTest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"celda_CG"</span>,</span>
<span>    nchains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    maxIter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    bestOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Setting <code>verbose</code> to <code>TRUE</code> will print the output of each model to a text file. These results can be visualized with <code>plotGridSearchPerplexity</code>. The major goal is to pick the lowest <code>K</code> and <code>L</code> combination with relatively good perplexity. In general, visual inspection of the plot can be used to select the number of modules (<code>L</code>) or cell populations (<code>K</code>) where the rate of decrease in the perplexity starts to drop off. <code>bestOnly = TRUE</code> indicates that only the chain with the best log likelihood will be returned for each K/L combination.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">cgs</span><span class="op">)</span></span></code></pre></div>
<p><img src="celda_files/figure-html/plot_grid_search-1.png" width="768"></p>
<p>In this example, the perplexity for <code>L</code> stops decreasing at L = 10 for the majority of <code>K</code> values. For the line corresponding to L = 10, the perplexity stops decreasing at K = 5. Thus L = 10 and K = 5 would be a good choice. Again, manual review of specific selections of K is often be required to ensure results are biologically coherent.</p>
<p>Once users have chosen the K/L parameters for further analysis, the <code>subsetCeldaList</code> function can be used to subset the celda list <em>SCE</em> object to a single model <em>SCE</em> object.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">cgs</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the “bestOnly” parameter is set to FALSE in the <code>celdaGridSearch</code>, then the <code>selectBestModel</code> function can be used to select the chains with the lowest log likelihoods within each combination of parameters. Alternatively, users can select a specific chain by specifying the index within the <code>subsetCeldaList</code> function.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/celdaGridSearch.html">celdaGridSearch</a></span><span class="op">(</span><span class="va">simsce</span>,</span>
<span>    paramsTest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"celda_CG"</span>,</span>
<span>    nchains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    maxIter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    bestOnly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resamplePerplexity.html">resamplePerplexity</a></span><span class="op">(</span><span class="va">cgs</span>, celdaList <span class="op">=</span> <span class="va">cgs</span>, resample <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cgsK5L10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">cgs</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectBestModel.html">selectBestModel</a></span><span class="op">(</span><span class="va">cgsK5L10</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="miscellaneous-utility-functions">Miscellaneous utility functions<a class="anchor" aria-label="anchor" href="#miscellaneous-utility-functions"></a>
</h2>
<p>celda also contains several utility functions for the users’ convenience.</p>
<div class="section level3">
<h3 id="finding-the-modules-for-feature-with-featuremodulelookup">Finding the modules for feature with featureModuleLookup<a class="anchor" aria-label="anchor" href="#finding-the-modules-for-feature-with-featuremodulelookup"></a>
</h3>
<p><code>featureModuleLookup</code> can be used to look up the module a specific feature was clustered to.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/featureModuleLookup.html">featureModuleLookup</a></span><span class="op">(</span><span class="va">sce</span>, feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene_99"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gene_99 </span></span>
<span><span class="co">##       4</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="reordering-cluster-labels-with-recodeclusterz-recodeclustery">Reordering cluster labels with recodeClusterZ, recodeClusterY<a class="anchor" aria-label="anchor" href="#reordering-cluster-labels-with-recodeclusterz-recodeclustery"></a>
</h3>
<p><code>recodeClusterZ</code> and <code>recodeClusterY</code> allows the user to recode the cell and feature cluster labels, respectively.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sceZRecoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recodeClusterZ.html">recodeClusterZ</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The model prior to reordering cell labels compared to after reordering cell labels:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="fu"><a href="../reference/celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">sceZRecoded</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##      1  2  3  4  5</span></span>
<span><span class="co">##   1  0 44  0  0  0</span></span>
<span><span class="co">##   2 42  0  0  0  0</span></span>
<span><span class="co">##   3  0  0 40  0  0</span></span>
<span><span class="co">##   4  0  0  0 47  0</span></span>
<span><span class="co">##   5  0  0  0  0 34</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur ... 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] celda_1.14.2                Matrix_1.5-3               </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.20.0 SummarizedExperiment_1.28.0</span></span>
<span><span class="co">##  [5] Biobase_2.58.0              GenomicRanges_1.50.2       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.34.4         IRanges_2.32.0             </span></span>
<span><span class="co">##  [9] S4Vectors_0.36.1            BiocGenerics_0.44.0        </span></span>
<span><span class="co">## [11] MatrixGenerics_1.10.0       matrixStats_0.63.0         </span></span>
<span><span class="co">## [13] BiocStyle_2.26.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] bitops_1.0-7               fs_1.5.2                  </span></span>
<span><span class="co">##   [3] doParallel_1.0.17          RColorBrewer_1.1-3        </span></span>
<span><span class="co">##   [5] httr_1.4.4                 rprojroot_2.0.3           </span></span>
<span><span class="co">##   [7] tools_4.2.2                bslib_0.4.2               </span></span>
<span><span class="co">##   [9] irlba_2.3.5.1              utf8_1.2.2                </span></span>
<span><span class="co">##  [11] R6_2.5.1                   uwot_0.1.14               </span></span>
<span><span class="co">##  [13] DBI_1.1.3                  colorspace_2.0-3          </span></span>
<span><span class="co">##  [15] GetoptLong_1.0.5           withr_2.5.0               </span></span>
<span><span class="co">##  [17] tidyselect_1.2.0           curl_4.3.3                </span></span>
<span><span class="co">##  [19] compiler_4.2.2             textshaping_0.3.6         </span></span>
<span><span class="co">##  [21] cli_3.5.0                  Cairo_1.6-0               </span></span>
<span><span class="co">##  [23] assertive.properties_0.0-5 enrichR_3.1               </span></span>
<span><span class="co">##  [25] desc_1.4.2                 DelayedArray_0.24.0       </span></span>
<span><span class="co">##  [27] labeling_0.4.2             assertive.files_0.0-2     </span></span>
<span><span class="co">##  [29] bookdown_0.31              sass_0.4.4                </span></span>
<span><span class="co">##  [31] scales_1.2.1               pkgdown_2.0.7             </span></span>
<span><span class="co">##  [33] systemfonts_1.0.4          stringr_1.5.0             </span></span>
<span><span class="co">##  [35] digest_0.6.31              rmarkdown_2.19            </span></span>
<span><span class="co">##  [37] XVector_0.38.0             assertive.numbers_0.0-2   </span></span>
<span><span class="co">##  [39] pkgconfig_2.0.3            htmltools_0.5.4           </span></span>
<span><span class="co">##  [41] highr_0.9                  fastmap_1.1.0             </span></span>
<span><span class="co">##  [43] GlobalOptions_0.1.2        rlang_1.0.6               </span></span>
<span><span class="co">##  [45] FNN_1.1.3.1                shape_1.4.6               </span></span>
<span><span class="co">##  [47] farver_2.1.1               gridGraphics_0.5-1        </span></span>
<span><span class="co">##  [49] jquerylib_0.1.4            generics_0.1.3            </span></span>
<span><span class="co">##  [51] combinat_0.0-8             jsonlite_1.8.4            </span></span>
<span><span class="co">##  [53] dplyr_1.0.10               RCurl_1.98-1.9            </span></span>
<span><span class="co">##  [55] magrittr_2.0.3             GenomeInfoDbData_1.2.9    </span></span>
<span><span class="co">##  [57] multipanelfigure_2.1.2     Rcpp_1.0.9                </span></span>
<span><span class="co">##  [59] munsell_0.5.0              fansi_1.0.3               </span></span>
<span><span class="co">##  [61] lifecycle_1.0.3            stringi_1.7.8             </span></span>
<span><span class="co">##  [63] assertive.base_0.0-9       yaml_2.3.6                </span></span>
<span><span class="co">##  [65] MCMCprecision_0.4.0        zlibbioc_1.44.0           </span></span>
<span><span class="co">##  [67] plyr_1.8.8                 Rtsne_0.16                </span></span>
<span><span class="co">##  [69] grid_4.2.2                 parallel_4.2.2            </span></span>
<span><span class="co">##  [71] ggrepel_0.9.2              crayon_1.5.2              </span></span>
<span><span class="co">##  [73] lattice_0.20-45            circlize_0.4.15           </span></span>
<span><span class="co">##  [75] magick_2.7.3               ComplexHeatmap_2.14.0     </span></span>
<span><span class="co">##  [77] knitr_1.41                 pillar_1.8.1              </span></span>
<span><span class="co">##  [79] rjson_0.2.21               reshape2_1.4.4            </span></span>
<span><span class="co">##  [81] codetools_0.2-18           glue_1.6.2                </span></span>
<span><span class="co">##  [83] evaluate_0.19              data.table_1.14.6         </span></span>
<span><span class="co">##  [85] BiocManager_1.30.19        png_0.1-8                 </span></span>
<span><span class="co">##  [87] vctrs_0.5.1                foreach_1.5.2             </span></span>
<span><span class="co">##  [89] gtable_0.3.1               purrr_1.0.0               </span></span>
<span><span class="co">##  [91] clue_0.3-63                assertthat_0.2.1          </span></span>
<span><span class="co">##  [93] cachem_1.0.6               ggplot2_3.4.0             </span></span>
<span><span class="co">##  [95] xfun_0.36                  assertive.types_0.0-3     </span></span>
<span><span class="co">##  [97] RcppEigen_0.3.3.9.3        ragg_1.2.4                </span></span>
<span><span class="co">##  [99] tibble_3.1.8               iterators_1.0.14          </span></span>
<span><span class="co">## [101] memoise_2.0.1              cluster_2.1.4</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
