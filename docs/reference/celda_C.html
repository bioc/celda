<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cell clustering with Celda — celda_C • celda</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cell clustering with Celda — celda_C"><meta property="og:description" content="Clusters the columns of a count matrix containing single-cell
 data into K subpopulations. The
 useAssay assay slot in
 altExpName altExp slot will be used if
 it exists. Otherwise, the useAssay
 assay slot in x will be used if
 x is a SingleCellExperiment object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.18.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://www.camplab.net/celda" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/campbio/celda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cell clustering with Celda</h1>
    <small class="dont-index">Source: <a href="https://github.com/campbio/celda/blob/HEAD/R/celda_C.R" class="external-link"><code>R/celda_C.R</code></a></small>
    <div class="hidden name"><code>celda_C.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clusters the columns of a count matrix containing single-cell
 data into K subpopulations. The
 <code>useAssay</code> assay slot in
 <code>altExpName</code> altExp slot will be used if
 it exists. Otherwise, the <code>useAssay</code>
 assay slot in <code>x</code> will be used if
 <code>x</code> is a SingleCellExperiment object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">celda_C</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EM"</span>, <span class="st">"Gibbs"</span><span class="op">)</span>,</span>
<span>  stopIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxIter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  splitOnIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  splitOnLast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  nchains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  zInitialize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"split"</span>, <span class="st">"random"</span>, <span class="st">"predefined"</span><span class="op">)</span>,</span>
<span>  countChecksum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SingleCellExperiment</span></span>
<span><span class="fu">celda_C</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EM"</span>, <span class="st">"Gibbs"</span><span class="op">)</span>,</span>
<span>  stopIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxIter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  splitOnIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  splitOnLast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  nchains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  zInitialize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"split"</span>, <span class="st">"random"</span>, <span class="st">"predefined"</span><span class="op">)</span>,</span>
<span>  countChecksum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY</span></span>
<span><span class="fu">celda_C</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EM"</span>, <span class="st">"Gibbs"</span><span class="op">)</span>,</span>
<span>  stopIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxIter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  splitOnIter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  splitOnLast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  nchains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  zInitialize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"split"</span>, <span class="st">"random"</span>, <span class="st">"predefined"</span><span class="op">)</span>,</span>
<span>  countChecksum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  zInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A SingleCellExperiment
with the matrix located in the assay slot under <code>useAssay</code>.
Rows represent features and columns represent cells. Alternatively,
any matrix-like object that can be coerced to a sparse matrix of class
"dgCMatrix" can be directly used as input. The matrix will automatically be
converted to a SingleCellExperiment object.</p></dd>


<dt>useAssay</dt>
<dd><p>A string specifying the name of the
assay slot to use. Default "counts".</p></dd>


<dt>altExpName</dt>
<dd><p>The name for the altExp slot
to use. Default "featureSubset".</p></dd>


<dt>sampleLabel</dt>
<dd><p>Vector or factor. Denotes the sample label for each cell
(column) in the count matrix.</p></dd>


<dt>K</dt>
<dd><p>Integer. Number of cell populations.</p></dd>


<dt>alpha</dt>
<dd><p>Numeric. Concentration parameter for Theta. Adds a pseudocount
to each cell population in each sample. Default 1.</p></dd>


<dt>beta</dt>
<dd><p>Numeric. Concentration parameter for Phi. Adds a pseudocount to
each feature in each cell population. Default 1.</p></dd>


<dt>algorithm</dt>
<dd><p>String. Algorithm to use for clustering cell subpopulations.
One of 'EM' or 'Gibbs'. The EM algorithm is faster, especially for larger
numbers of cells. However, more chains may be required to ensure a good
solution is found. If 'EM' is selected, then 'stopIter' will be
automatically set to 1. Default 'EM'.</p></dd>


<dt>stopIter</dt>
<dd><p>Integer. Number of iterations without improvement in the
log likelihood to stop inference. Default 10.</p></dd>


<dt>maxIter</dt>
<dd><p>Integer. Maximum number of iterations of Gibbs sampling or
EM to perform. Default 200.</p></dd>


<dt>splitOnIter</dt>
<dd><p>Integer. On every `splitOnIter` iteration, a heuristic
will be applied to determine if a cell population should be reassigned and
another cell population should be split into two clusters. To disable
splitting, set to -1. Default 10.</p></dd>


<dt>splitOnLast</dt>
<dd><p>Integer. After `stopIter` iterations have been
performed without improvement, a heuristic will be applied to determine if
a cell population should be reassigned and another cell population should be
split into two clusters. If a split occurs, then `stopIter` will be reset.
Default TRUE.</p></dd>


<dt>seed</dt>
<dd><p>Integer. Passed to <a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a>. For reproducibility,
a default value of 12345 is used. If NULL, no calls to
<a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a> are made.</p></dd>


<dt>nchains</dt>
<dd><p>Integer. Number of random cluster initializations. Default 3.</p></dd>


<dt>zInitialize</dt>
<dd><p>Character. One of 'random', 'split', or 'predefined'.
With 'random', cells are randomly assigned to a populations. With 'split',
cells will be split into sqrt(K) populations and then each population will
be subsequently split into another sqrt(K) populations. With 'predefined',
values in `zInit` will be used to initialize `z`. Default 'split'.</p></dd>


<dt>countChecksum</dt>
<dd><p>Character. An MD5 checksum for the `counts` matrix.
Default NULL.</p></dd>


<dt>zInit</dt>
<dd><p>Integer vector. Sets initial starting values of z. 'zInit'
is only used when `zInitialize = 'predfined'`. Default NULL.</p></dd>


<dt>logfile</dt>
<dd><p>Character. Messages will be redirected to a file named
`logfile`. If NULL, messages will be printed to stdout.  Default NULL.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. Whether to print log messages. Default TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a> object. Function
 parameter settings are stored in the metadata</p>
<p></p>
<p><code>"celda_parameters"</code> slot.
 Columns <code>celda_sample_label</code> and <code>celda_cell_cluster</code> in</p>
<p></p>
<p>colData contain sample labels and celda cell
 population clusters.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="celda_G.html">celda_G</a> for feature clustering and <a href="celda_CG.html">celda_CG</a> for
 simultaneous clustering of features and cells. <a href="celdaGridSearch.html">celdaGridSearch</a> can
 be used to run multiple values of K and multiple chains in parallel.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">celdaCSim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">celda_C</span><span class="op">(</span><span class="va">celdaCSim</span><span class="op">$</span><span class="va">counts</span>,</span></span>
<span class="r-in"><span>    K <span class="op">=</span> <span class="va">celdaCSim</span><span class="op">$</span><span class="va">K</span>,</span></span>
<span class="r-in"><span>    sampleLabel <span class="op">=</span> <span class="va">celdaCSim</span><span class="op">$</span><span class="va">sampleLabel</span>,</span></span>
<span class="r-in"><span>    nchains <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting Celda_C: Clustering cells.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:54:46 2024 .. Initializing 'z' in chain 1 with 'split' </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:54:46 2024 .... Completed iteration: 1 | logLik: -1282027.27277705</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:54:46 2024 .... Completed iteration: 2 | logLik: -1282027.27277705</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:54:46 2024 .. Finished chain 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed Celda_C. Total time: 0.1405442 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

