<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plots heatmap based on Celda model — plotHeatmap • celda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plots heatmap based on Celda model — plotHeatmap" />
<meta property="og:description" content="Renders a heatmap based on a matrix of counts where rows are
 features and columns are cells." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://celda.camplab.net/">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/campbio/celda/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots heatmap based on Celda model</h1>
    <small class="dont-index">Source: <a href='https://github.com/campbio/celda/blob/master/R/plotHeatmap.R'><code>R/plotHeatmap.R</code></a></small>
    <div class="hidden name"><code>plotHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Renders a heatmap based on a matrix of counts where rows are
 features and columns are cells.</p>
    </div>

    <pre class="usage"><span class='fu'>plotHeatmap</span><span class='op'>(</span>
  <span class='va'>counts</span>,
  z <span class='op'>=</span> <span class='cn'>NULL</span>,
  y <span class='op'>=</span> <span class='cn'>NULL</span>,
  scaleRow <span class='op'>=</span> <span class='va'>scale</span>,
  trim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
  featureIx <span class='op'>=</span> <span class='cn'>NULL</span>,
  cellIx <span class='op'>=</span> <span class='cn'>NULL</span>,
  clusterFeature <span class='op'>=</span> <span class='cn'>TRUE</span>,
  clusterCell <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colorScheme <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"divergent"</span>, <span class='st'>"sequential"</span><span class='op'>)</span>,
  colorSchemeSymmetric <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colorSchemeCenter <span class='op'>=</span> <span class='fl'>0</span>,
  col <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotationCell <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotationFeature <span class='op'>=</span> <span class='cn'>NULL</span>,
  annotationColor <span class='op'>=</span> <span class='cn'>NULL</span>,
  breaks <span class='op'>=</span> <span class='cn'>NULL</span>,
  legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  annotationLegend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  annotationNamesFeature <span class='op'>=</span> <span class='cn'>TRUE</span>,
  annotationNamesCell <span class='op'>=</span> <span class='cn'>TRUE</span>,
  showNamesFeature <span class='op'>=</span> <span class='cn'>FALSE</span>,
  showNamesCell <span class='op'>=</span> <span class='cn'>FALSE</span>,
  rowGroupOrder <span class='op'>=</span> <span class='cn'>NULL</span>,
  colGroupOrder <span class='op'>=</span> <span class='cn'>NULL</span>,
  hclustMethod <span class='op'>=</span> <span class='st'>"ward.D2"</span>,
  treeheightFeature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>clusterFeature</span>, <span class='fl'>50</span>, <span class='fl'>0</span><span class='op'>)</span>,
  treeheightCell <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>clusterCell</span>, <span class='fl'>50</span>, <span class='fl'>0</span><span class='op'>)</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>Numeric or sparse matrix. Normalized counts matrix where rows
represent features and columns represent cells. .</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>Numeric vector. Denotes cell population labels.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Numeric vector. Denotes feature module labels.</p></td>
    </tr>
    <tr>
      <th>scaleRow</th>
      <td><p>Function. A function to scale each individual row. Set to
NULL to disable. Occurs after normalization and log transformation. Defualt
is 'scale' and thus will Z-score transform each row.</p></td>
    </tr>
    <tr>
      <th>trim</th>
      <td><p>Numeric vector. Vector of length two that specifies the lower
and upper bounds for the data. This threshold is applied after row scaling.
Set to NULL to disable. Default c(-2,2).</p></td>
    </tr>
    <tr>
      <th>featureIx</th>
      <td><p>Integer vector. Select features for display in heatmap. If
NULL, no subsetting will be performed. Default NULL.</p></td>
    </tr>
    <tr>
      <th>cellIx</th>
      <td><p>Integer vector. Select cells for display in heatmap. If NULL,
no subsetting will be performed. Default NULL.</p></td>
    </tr>
    <tr>
      <th>clusterFeature</th>
      <td><p>Logical. Determines whether rows should be clustered.
Default TRUE.</p></td>
    </tr>
    <tr>
      <th>clusterCell</th>
      <td><p>Logical. Determines whether columns should be clustered.
Default TRUE.</p></td>
    </tr>
    <tr>
      <th>colorScheme</th>
      <td><p>Character. One of "divergent" or "sequential". A
"divergent" scheme is best for highlighting relative data (denoted by
'colorSchemeCenter') such as gene expression data that has been normalized
and centered. A "sequential" scheme is best for highlighting data that
are ordered low to high such as raw counts or probabilities. Default
"divergent".</p></td>
    </tr>
    <tr>
      <th>colorSchemeSymmetric</th>
      <td><p>Logical. When the colorScheme is "divergent"
and the data contains both positive and negative numbers, TRUE indicates
that the color scheme should be symmetric from
<code>[-max(abs(data)), max(abs(data))]</code>. For example, if the data ranges
goes from -1.5 to 2, then setting this to TRUE will force the color scheme
to range from -2 to 2. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>colorSchemeCenter</th>
      <td><p>Numeric. Indicates the center of a "divergent"
colorScheme. Default 0.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>Color for the heatmap.</p></td>
    </tr>
    <tr>
      <th>annotationCell</th>
      <td><p>Data frame. Additional annotations for each cell will
be shown in the column color bars. The format of the data frame should be
one row for each cell and one column for each annotation. Numeric variables
will be displayed as continuous color bars and factors will be displayed as
discrete color bars. Default NULL.</p></td>
    </tr>
    <tr>
      <th>annotationFeature</th>
      <td><p>A data frame for the feature annotations (rows).</p></td>
    </tr>
    <tr>
      <th>annotationColor</th>
      <td><p>List. Contains color scheme for all annotations. See
`?pheatmap` for more details.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Numeric vector. A sequence of numbers that covers the range
of values in the normalized `counts`. Values in the normalized `matrix` are
assigned to each bin in `breaks`. Each break is assigned to a unique color
from `col`. If NULL, then breaks are calculated automatically. Default NULL.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>Logical. Determines whether legend should be drawn. Default
TRUE.</p></td>
    </tr>
    <tr>
      <th>annotationLegend</th>
      <td><p>Logical. Whether legend for all annotations should
be drawn. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>annotationNamesFeature</th>
      <td><p>Logical. Whether the names for features should
be shown. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>annotationNamesCell</th>
      <td><p>Logical. Whether the names for cells should be
shown. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>showNamesFeature</th>
      <td><p>Logical. Specifies if feature names should be shown.
Default TRUE.</p></td>
    </tr>
    <tr>
      <th>showNamesCell</th>
      <td><p>Logical. Specifies if cell names should be shown.
Default FALSE.</p></td>
    </tr>
    <tr>
      <th>rowGroupOrder</th>
      <td><p>Vector. Specifies the order of feature clusters when
semisupervised clustering is performed on the <code>y</code> labels.</p></td>
    </tr>
    <tr>
      <th>colGroupOrder</th>
      <td><p>Vector. Specifies the order of cell clusters when
semisupervised clustering is performed on the <code>z</code> labels.</p></td>
    </tr>
    <tr>
      <th>hclustMethod</th>
      <td><p>Character. Specifies the method to use for the 'hclust'
function. See `?hclust` for possible values. Default "ward.D2".</p></td>
    </tr>
    <tr>
      <th>treeheightFeature</th>
      <td><p>Numeric. Width of the feature dendrogram. Set to 0
to disable plotting of this dendrogram. Default: if clusterFeature == TRUE,
then treeheightFeature = 50, else treeheightFeature = 0.</p></td>
    </tr>
    <tr>
      <th>treeheightCell</th>
      <td><p>Numeric. Height of the cell dendrogram. Set to 0 to
disable plotting of this dendrogram. Default: if clusterCell == TRUE, then
treeheightCell = 50, else treeheightCell = 0.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>Logical. Whether to plot the heatmap.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to be passed to underlying pheatmap function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list A list containing dendrogram information and the heatmap grob</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>celdaCGSim</span>, <span class='va'>celdaCGMod</span><span class='op'>)</span>
<span class='fu'>plotHeatmap</span><span class='op'>(</span><span class='va'>celdaCGSim</span><span class='op'>$</span><span class='va'>counts</span>,
  z <span class='op'>=</span> <span class='fu'><a href='celdaClusters.html'>celdaClusters</a></span><span class='op'>(</span><span class='va'>celdaCGMod</span><span class='op'>)</span><span class='op'>$</span><span class='va'>z</span>, y <span class='op'>=</span> <span class='fu'><a href='celdaClusters.html'>celdaClusters</a></span><span class='op'>(</span><span class='va'>celdaCGMod</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; TableGrob (5 x 6) "layout": 9 grobs
#&gt;   z     cells                 name                          grob
#&gt; 1 1 (2-2,3-3)             col_tree polyline[GRID.polyline.12828]
#&gt; 2 2 (4-4,1-1)             row_tree polyline[GRID.polyline.12829]
#&gt; 3 3 (4-4,3-3)               matrix       gTree[GRID.gTree.12831]
#&gt; 4 4 (3-3,3-3)       col_annotation         rect[GRID.rect.12832]
#&gt; 5 5 (3-3,4-4) col_annotation_names         text[GRID.text.12833]
#&gt; 6 6 (4-4,2-2)       row_annotation         rect[GRID.rect.12834]
#&gt; 7 7 (5-5,2-2) row_annotation_names         text[GRID.text.12835]
#&gt; 8 8 (4-5,6-6)     annotationLegend       gTree[GRID.gTree.12843]
#&gt; 9 9 (4-5,5-5)               legend       gTree[GRID.gTree.12846]</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


