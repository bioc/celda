<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots heatmap based on Celda model — plotHeatmap • celda</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots heatmap based on Celda model — plotHeatmap"><meta property="og:description" content="Renders a heatmap based on a matrix of counts where rows are
 features and columns are cells."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.18.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://www.camplab.net/celda" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/campbio/celda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots heatmap based on Celda model</h1>
    <small class="dont-index">Source: <a href="https://github.com/campbio/celda/blob/HEAD/R/plotHeatmap.R" class="external-link"><code>R/plotHeatmap.R</code></a></small>
    <div class="hidden name"><code>plotHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Renders a heatmap based on a matrix of counts where rows are
 features and columns are cells.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotHeatmap</span><span class="op">(</span></span>
<span>  <span class="va">counts</span>,</span>
<span>  z <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleRow <span class="op">=</span> <span class="va">scale</span>,</span>
<span>  trim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  featureIx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cellIx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusterFeature <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clusterCell <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorScheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"divergent"</span>, <span class="st">"sequential"</span><span class="op">)</span>,</span>
<span>  colorSchemeSymmetric <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorSchemeCenter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotationCell <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotationFeature <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotationColor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotationLegend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotationNamesFeature <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotationNamesCell <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showNamesFeature <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showNamesCell <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rowGroupOrder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGroupOrder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hclustMethod <span class="op">=</span> <span class="st">"ward.D2"</span>,</span>
<span>  treeheightFeature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">clusterFeature</span>, <span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  treeheightCell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">clusterCell</span>, <span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>counts</dt>
<dd><p>Numeric or sparse matrix. Normalized counts matrix where rows
represent features and columns represent cells. .</p></dd>


<dt>z</dt>
<dd><p>Numeric vector. Denotes cell population labels.</p></dd>


<dt>y</dt>
<dd><p>Numeric vector. Denotes feature module labels.</p></dd>


<dt>scaleRow</dt>
<dd><p>Function. A function to scale each individual row. Set to
NULL to disable. Occurs after normalization and log transformation. Defualt
is 'scale' and thus will Z-score transform each row.</p></dd>


<dt>trim</dt>
<dd><p>Numeric vector. Vector of length two that specifies the lower
and upper bounds for the data. This threshold is applied after row scaling.
Set to NULL to disable. Default c(-2,2).</p></dd>


<dt>featureIx</dt>
<dd><p>Integer vector. Select features for display in heatmap. If
NULL, no subsetting will be performed. Default NULL.</p></dd>


<dt>cellIx</dt>
<dd><p>Integer vector. Select cells for display in heatmap. If NULL,
no subsetting will be performed. Default NULL.</p></dd>


<dt>clusterFeature</dt>
<dd><p>Logical. Determines whether rows should be clustered.
Default TRUE.</p></dd>


<dt>clusterCell</dt>
<dd><p>Logical. Determines whether columns should be clustered.
Default TRUE.</p></dd>


<dt>colorScheme</dt>
<dd><p>Character. One of "divergent" or "sequential". A
"divergent" scheme is best for highlighting relative data (denoted by
'colorSchemeCenter') such as gene expression data that has been normalized
and centered. A "sequential" scheme is best for highlighting data that
are ordered low to high such as raw counts or probabilities. Default
"divergent".</p></dd>


<dt>colorSchemeSymmetric</dt>
<dd><p>Logical. When the colorScheme is "divergent"
and the data contains both positive and negative numbers, TRUE indicates
that the color scheme should be symmetric from
<code>[-max(abs(data)), max(abs(data))]</code>. For example, if the data ranges
goes from -1.5 to 2, then setting this to TRUE will force the color scheme
to range from -2 to 2. Default TRUE.</p></dd>


<dt>colorSchemeCenter</dt>
<dd><p>Numeric. Indicates the center of a "divergent"
colorScheme. Default 0.</p></dd>


<dt>col</dt>
<dd><p>Color for the heatmap.</p></dd>


<dt>annotationCell</dt>
<dd><p>Data frame. Additional annotations for each cell will
be shown in the column color bars. The format of the data frame should be
one row for each cell and one column for each annotation. Numeric variables
will be displayed as continuous color bars and factors will be displayed as
discrete color bars. Default NULL.</p></dd>


<dt>annotationFeature</dt>
<dd><p>A data frame for the feature annotations (rows).</p></dd>


<dt>annotationColor</dt>
<dd><p>List. Contains color scheme for all annotations. See
`?pheatmap` for more details.</p></dd>


<dt>breaks</dt>
<dd><p>Numeric vector. A sequence of numbers that covers the range
of values in the normalized `counts`. Values in the normalized `matrix` are
assigned to each bin in `breaks`. Each break is assigned to a unique color
from `col`. If NULL, then breaks are calculated automatically. Default NULL.</p></dd>


<dt>legend</dt>
<dd><p>Logical. Determines whether legend should be drawn. Default
TRUE.</p></dd>


<dt>annotationLegend</dt>
<dd><p>Logical. Whether legend for all annotations should
be drawn. Default TRUE.</p></dd>


<dt>annotationNamesFeature</dt>
<dd><p>Logical. Whether the names for features should
be shown. Default TRUE.</p></dd>


<dt>annotationNamesCell</dt>
<dd><p>Logical. Whether the names for cells should be
shown. Default TRUE.</p></dd>


<dt>showNamesFeature</dt>
<dd><p>Logical. Specifies if feature names should be shown.
Default TRUE.</p></dd>


<dt>showNamesCell</dt>
<dd><p>Logical. Specifies if cell names should be shown.
Default FALSE.</p></dd>


<dt>rowGroupOrder</dt>
<dd><p>Vector. Specifies the order of feature clusters when
semisupervised clustering is performed on the <code>y</code> labels.</p></dd>


<dt>colGroupOrder</dt>
<dd><p>Vector. Specifies the order of cell clusters when
semisupervised clustering is performed on the <code>z</code> labels.</p></dd>


<dt>hclustMethod</dt>
<dd><p>Character. Specifies the method to use for the 'hclust'
function. See `?hclust` for possible values. Default "ward.D2".</p></dd>


<dt>treeheightFeature</dt>
<dd><p>Numeric. Width of the feature dendrogram. Set to 0
to disable plotting of this dendrogram. Default: if clusterFeature == TRUE,
then treeheightFeature = 50, else treeheightFeature = 0.</p></dd>


<dt>treeheightCell</dt>
<dd><p>Numeric. Height of the cell dendrogram. Set to 0 to
disable plotting of this dendrogram. Default: if clusterCell == TRUE, then
treeheightCell = 50, else treeheightCell = 0.</p></dd>


<dt>silent</dt>
<dd><p>Logical. Whether to plot the heatmap.</p></dd>


<dt>...</dt>
<dd><p>Other arguments to be passed to underlying pheatmap function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list A list containing dendrogram information and the heatmap grob</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">celdaCGSim</span>, <span class="va">celdaCGMod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotHeatmap</span><span class="op">(</span><span class="va">celdaCGSim</span><span class="op">$</span><span class="va">counts</span>,</span></span>
<span class="r-in"><span>  z <span class="op">=</span> <span class="fu"><a href="celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">celdaCGMod</span><span class="op">)</span><span class="op">$</span><span class="va">z</span>, y <span class="op">=</span> <span class="fu"><a href="celdaClusters.html">celdaClusters</a></span><span class="op">(</span><span class="va">celdaCGMod</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TableGrob (5 x 6) "layout": 9 grobs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   z     cells                 name                          grob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 (2-2,3-3)             col_tree polyline[GRID.polyline.12713]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2 (4-4,1-1)             row_tree polyline[GRID.polyline.12714]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3 (4-4,3-3)               matrix       gTree[GRID.gTree.12716]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4 (3-3,3-3)       col_annotation         rect[GRID.rect.12717]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 5 (3-3,4-4) col_annotation_names         text[GRID.text.12718]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 6 (4-4,2-2)       row_annotation         rect[GRID.rect.12719]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 7 (5-5,2-2) row_annotation_names         text[GRID.text.12720]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 8 (4-5,6-6)     annotationLegend       gTree[GRID.gTree.12728]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 9 (4-5,5-5)               legend       gTree[GRID.gTree.12731]</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

