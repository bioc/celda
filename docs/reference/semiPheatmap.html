<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A function to draw clustered heatmaps. — semiPheatmap • celda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="A function to draw clustered heatmaps. — semiPheatmap" />
<meta property="og:description" content="A function to draw clustered heatmaps where one has better
 control over some graphical parameters such as cell size, etc.
The function also allows to aggregate the rows using kmeans clustering.
 This is advisable if number of rows is so big that R cannot handle their
 hierarchical clustering anymore, roughly more than 1000. Instead of showing
 all the rows separately one can cluster the rows in advance and show only
 the cluster centers. The number of clusters can be tuned with parameter
 kmeansK." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://celda.camplab.net/">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/campbio/celda/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A function to draw clustered heatmaps.</h1>
    <small class="dont-index">Source: <a href='https://github.com/campbio/celda/blob/master/R/semi_pheatmap.R'><code>R/semi_pheatmap.R</code></a></small>
    <div class="hidden name"><code>semiPheatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function to draw clustered heatmaps where one has better
 control over some graphical parameters such as cell size, etc.</p>
<p>The function also allows to aggregate the rows using kmeans clustering.
 This is advisable if number of rows is so big that R cannot handle their
 hierarchical clustering anymore, roughly more than 1000. Instead of showing
 all the rows separately one can cluster the rows in advance and show only
 the cluster centers. The number of clusters can be tuned with parameter
 kmeansK.</p>
    </div>

    <pre class="usage"><span class='fu'>semiPheatmap</span><span class='op'>(</span>
  <span class='va'>mat</span>,
  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'>brewer.pal</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>7</span>, name <span class='op'>=</span> <span class='st'>"RdYlBu"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,
  kmeansK <span class='op'>=</span> <span class='cn'>NA</span>,
  breaks <span class='op'>=</span> <span class='cn'>NA</span>,
  borderColor <span class='op'>=</span> <span class='st'>"grey60"</span>,
  cellWidth <span class='op'>=</span> <span class='cn'>NA</span>,
  cellHeight <span class='op'>=</span> <span class='cn'>NA</span>,
  scale <span class='op'>=</span> <span class='st'>"none"</span>,
  clusterRows <span class='op'>=</span> <span class='cn'>TRUE</span>,
  clusterCols <span class='op'>=</span> <span class='cn'>TRUE</span>,
  clusteringDistanceRows <span class='op'>=</span> <span class='st'>"euclidean"</span>,
  clusteringDistanceCols <span class='op'>=</span> <span class='st'>"euclidean"</span>,
  clusteringMethod <span class='op'>=</span> <span class='st'>"complete"</span>,
  clusteringCallback <span class='op'>=</span> <span class='va'>.identity2</span>,
  cutreeRows <span class='op'>=</span> <span class='cn'>NA</span>,
  cutreeCols <span class='op'>=</span> <span class='cn'>NA</span>,
  treeHeightRow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>clusterRows</span>, <span class='fl'>50</span>, <span class='fl'>0</span><span class='op'>)</span>,
  treeHeightCol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>clusterCols</span>, <span class='fl'>50</span>, <span class='fl'>0</span><span class='op'>)</span>,
  legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  legendBreaks <span class='op'>=</span> <span class='cn'>NA</span>,
  legendLabels <span class='op'>=</span> <span class='cn'>NA</span>,
  annotationRow <span class='op'>=</span> <span class='cn'>NA</span>,
  annotationCol <span class='op'>=</span> <span class='cn'>NA</span>,
  annotation <span class='op'>=</span> <span class='cn'>NA</span>,
  annotationColors <span class='op'>=</span> <span class='cn'>NA</span>,
  annotationLegend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  annotationNamesRow <span class='op'>=</span> <span class='cn'>TRUE</span>,
  annotationNamesCol <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dropLevels <span class='op'>=</span> <span class='cn'>TRUE</span>,
  showRownames <span class='op'>=</span> <span class='cn'>TRUE</span>,
  showColnames <span class='op'>=</span> <span class='cn'>TRUE</span>,
  main <span class='op'>=</span> <span class='cn'>NA</span>,
  fontSize <span class='op'>=</span> <span class='fl'>10</span>,
  fontSizeRow <span class='op'>=</span> <span class='va'>fontSize</span>,
  fontSizeCol <span class='op'>=</span> <span class='va'>fontSize</span>,
  displayNumbers <span class='op'>=</span> <span class='cn'>FALSE</span>,
  numberFormat <span class='op'>=</span> <span class='st'>"%.2f"</span>,
  numberColor <span class='op'>=</span> <span class='st'>"grey30"</span>,
  fontSizeNumber <span class='op'>=</span> <span class='fl'>0.8</span> <span class='op'>*</span> <span class='va'>fontSize</span>,
  gapsRow <span class='op'>=</span> <span class='cn'>NULL</span>,
  gapsCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  labelsRow <span class='op'>=</span> <span class='cn'>NULL</span>,
  labelsCol <span class='op'>=</span> <span class='cn'>NULL</span>,
  fileName <span class='op'>=</span> <span class='cn'>NA</span>,
  width <span class='op'>=</span> <span class='cn'>NA</span>,
  height <span class='op'>=</span> <span class='cn'>NA</span>,
  silent <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>rowLabel</span>,
  <span class='va'>colLabel</span>,
  rowGroupOrder <span class='op'>=</span> <span class='cn'>NULL</span>,
  colGroupOrder <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat</th>
      <td><p>numeric matrix of the values to be plotted.</p></td>
    </tr>
    <tr>
      <th>color</th>
      <td><p>vector of colors used in heatmap.</p></td>
    </tr>
    <tr>
      <th>kmeansK</th>
      <td><p>the number of kmeans clusters to make, if we want to
agggregate the rows before drawing heatmap. If NA then the rows are not
aggregated.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Numeric vector. A sequence of numbers that covers the range
of values in the normalized `counts`. Values in the normalized `matrix` are
assigned to each bin in `breaks`. Each break is assigned to a unique color
from `col`. If NULL, then breaks are calculated automatically. Default NULL.</p></td>
    </tr>
    <tr>
      <th>borderColor</th>
      <td><p>color of cell borders on heatmap, use NA if no border
should be drawn.</p></td>
    </tr>
    <tr>
      <th>cellWidth</th>
      <td><p>individual cell width in points. If left as NA, then the
values depend on the size of plotting window.</p></td>
    </tr>
    <tr>
      <th>cellHeight</th>
      <td><p>individual cell height in points. If left as NA, then the
values depend on the size of plotting window.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>character indicating if the values should be centered and
scaled in either the row direction or the column direction, or none.
Corresponding values are <code>"row"</code>, <code>"column"</code> and <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>clusterRows</th>
      <td><p>boolean values determining if rows should be clustered or
<code>hclust</code> object,</p></td>
    </tr>
    <tr>
      <th>clusterCols</th>
      <td><p>boolean values determining if columns should be clustered
or <code>hclust</code> object.</p></td>
    </tr>
    <tr>
      <th>clusteringDistanceRows</th>
      <td><p>distance measure used in clustering rows.
Possible values are <code>"correlation"</code> for Pearson correlation and all
the distances supported by <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>, such as <code>"euclidean"</code>,
etc. If the value is none of the above it is assumed that a distance matrix
is provided.</p></td>
    </tr>
    <tr>
      <th>clusteringDistanceCols</th>
      <td><p>distance measure used in clustering columns.
Possible values the same as for clusteringDistanceRows.</p></td>
    </tr>
    <tr>
      <th>clusteringMethod</th>
      <td><p>clustering method used. Accepts the same values as
<code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>.</p></td>
    </tr>
    <tr>
      <th>clusteringCallback</th>
      <td><p>callback function to modify the clustering. Is
called with two parameters: original <code>hclust</code> object and the matrix
used for clustering. Must return a <code>hclust</code> object.</p></td>
    </tr>
    <tr>
      <th>cutreeRows</th>
      <td><p>number of clusters the rows are divided into, based on the
hierarchical clustering (using cutree), if rows are not clustered, the
argument is ignored</p></td>
    </tr>
    <tr>
      <th>cutreeCols</th>
      <td><p>similar to <code>cutreeRows</code>, but for columns</p></td>
    </tr>
    <tr>
      <th>treeHeightRow</th>
      <td><p>the height of a tree for rows, if these are clustered.
Default value 50 points.</p></td>
    </tr>
    <tr>
      <th>treeHeightCol</th>
      <td><p>the height of a tree for columns, if these are
clustered. Default value 50 points.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>logical to determine if legend should be drawn or not.</p></td>
    </tr>
    <tr>
      <th>legendBreaks</th>
      <td><p>vector of breakpoints for the legend.</p></td>
    </tr>
    <tr>
      <th>legendLabels</th>
      <td><p>vector of labels for the <code>legendBreaks</code>.</p></td>
    </tr>
    <tr>
      <th>annotationRow</th>
      <td><p>data frame that specifies the annotations shown on left
side of the heatmap. Each row defines the features for a specific row. The
rows in the data and in the annotation are matched using corresponding row
names. Note that color schemes takes into account if variable is continuous
or discrete.</p></td>
    </tr>
    <tr>
      <th>annotationCol</th>
      <td><p>similar to annotationRow, but for columns.</p></td>
    </tr>
    <tr>
      <th>annotation</th>
      <td><p>deprecated parameter that currently sets the annotationCol
if it is missing.</p></td>
    </tr>
    <tr>
      <th>annotationColors</th>
      <td><p>list for specifying annotationRow and
annotationCol track colors manually. It is  possible to define the colors
for only some of the features. Check examples for  details.</p></td>
    </tr>
    <tr>
      <th>annotationLegend</th>
      <td><p>boolean value showing if the legend for annotation
tracks should be drawn.</p></td>
    </tr>
    <tr>
      <th>annotationNamesRow</th>
      <td><p>boolean value showing if the names for row
annotation tracks should be drawn.</p></td>
    </tr>
    <tr>
      <th>annotationNamesCol</th>
      <td><p>boolean value showing if the names for column
annotation tracks should be drawn.</p></td>
    </tr>
    <tr>
      <th>dropLevels</th>
      <td><p>logical to determine if unused levels are also shown in
the legend.</p></td>
    </tr>
    <tr>
      <th>showRownames</th>
      <td><p>boolean specifying if column names are be shown.</p></td>
    </tr>
    <tr>
      <th>showColnames</th>
      <td><p>boolean specifying if column names are be shown.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>the title of the plot</p></td>
    </tr>
    <tr>
      <th>fontSize</th>
      <td><p>base fontsize for the plot</p></td>
    </tr>
    <tr>
      <th>fontSizeRow</th>
      <td><p>fontsize for rownames (Default: fontsize)</p></td>
    </tr>
    <tr>
      <th>fontSizeCol</th>
      <td><p>fontsize for colnames (Default: fontsize)</p></td>
    </tr>
    <tr>
      <th>displayNumbers</th>
      <td><p>logical determining if the numeric values are also
printed to the cells. If this is a matrix (with same dimensions as original
matrix), the contents of the matrix are shown instead of original values.</p></td>
    </tr>
    <tr>
      <th>numberFormat</th>
      <td><p>format strings (C printf style) of the numbers shown in
cells. For example "<code>%.2f</code>" shows 2 decimal places and "<code>%.1e</code>"
shows exponential notation (see more in <code><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></code>).</p></td>
    </tr>
    <tr>
      <th>numberColor</th>
      <td><p>color of the text</p></td>
    </tr>
    <tr>
      <th>fontSizeNumber</th>
      <td><p>fontsize of the numbers displayed in cells</p></td>
    </tr>
    <tr>
      <th>gapsRow</th>
      <td><p>vector of row indices that show shere to put gaps into
heatmap. Used only if the rows are not clustered. See <code>cutreeRow</code>
to see how to introduce gaps to clustered rows.</p></td>
    </tr>
    <tr>
      <th>gapsCol</th>
      <td><p>similar to gapsRow, but for columns.</p></td>
    </tr>
    <tr>
      <th>labelsRow</th>
      <td><p>custom labels for rows that are used instead of rownames.</p></td>
    </tr>
    <tr>
      <th>labelsCol</th>
      <td><p>similar to labelsRow, but for columns.</p></td>
    </tr>
    <tr>
      <th>fileName</th>
      <td><p>file path where to save the picture. Filetype is decided by
the extension in the path. Currently following formats are supported: png,
pdf, tiff, bmp, jpeg. Even if the plot does not fit into the plotting
window, the file size is calculated so that the plot would fit there,
unless specified otherwise.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>manual option for determining the output file width in inches.</p></td>
    </tr>
    <tr>
      <th>height</th>
      <td><p>manual option for determining the output file height in inches.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>do not draw the plot (useful when using the gtable output)</p></td>
    </tr>
    <tr>
      <th>rowLabel</th>
      <td><p>row cluster labels for semi-clustering</p></td>
    </tr>
    <tr>
      <th>colLabel</th>
      <td><p>column cluster labels for semi-clustering</p></td>
    </tr>
    <tr>
      <th>rowGroupOrder</th>
      <td><p>Vector. Specifies the order of feature clusters when
semisupervised clustering is performed on the <code>y</code> labels.</p></td>
    </tr>
    <tr>
      <th>colGroupOrder</th>
      <td><p>Vector. Specifies the order of cell clusters when
semisupervised clustering is performed on the <code>z</code> labels.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>graphical parameters for the text used in plot. Parameters
passed to <code>grid.text</code>, see <code>gpar</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invisibly a list of components</p><ul>
<li><p><code>treeRow</code> the clustering of rows as <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>
      object</p></li>
<li><p><code>treeCol</code> the clustering of columns as <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>
      object</p></li>
<li><p><code>kmeans</code> the kmeans clustering of rows if parameter
      <code>kmeansK</code> was specified</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Raivo Kolde &lt;rkolde@gmail.com&gt;
#@examples
# Create test matrix
test = matrix(rnorm(200), 20, 10)
test[seq(10), seq(1, 10, 2)] = test[seq(10), seq(1, 10, 2)] + 3
test[seq(11, 20), seq(2, 10, 2)] = test[seq(11, 20), seq(2, 10, 2)] + 2
test[seq(15, 20), seq(2, 10, 2)] = test[seq(15, 20), seq(2, 10, 2)] + 4
colnames(test) = paste("Test", seq(10), sep = "")
rownames(test) = paste("Gene", seq(20), sep = "")</p>
<p># Draw heatmaps
pheatmap(test)
pheatmap(test, kmeansK = 2)
pheatmap(test, scale = "row", clusteringDistanceRows = "correlation")
pheatmap(test, color = colorRampPalette(c("navy",
    "white", "firebrick3"))(50))
pheatmap(test, cluster_row = FALSE)
pheatmap(test, legend = FALSE)</p>
<p># Show text within cells
pheatmap(test, displayNumbers = TRUE)
pheatmap(test, displayNumbers = TRUE, numberFormat = "%.1e")
pheatmap(test, displayNumbers = matrix(ifelse(test &gt; 5,
    "*", ""), nrow(test)))
pheatmap(test, cluster_row = FALSE,
    legendBreaks = seq(-1, 4), legendLabels = c("0",
    "1e-4", "1e-3", "1e-2", "1e-1", "1"))</p>
<p># Fix cell sizes and save to file with correct size
pheatmap(test, cellWidth = 15, cellHeight = 12, main = "Example heatmap")
pheatmap(test, cellWidth = 15, cellHeight = 12, fontSize = 8,
    fileName = "test.pdf")</p>
<p># Generate annotations for rows and columns
annotationCol = data.frame(CellType = factor(rep(c("CT1", "CT2"), 5)),
    Time = seq(5))
rownames(annotationCol) = paste("Test", seq(10), sep = "")</p>
<p>annotationRow = data.frame(GeneClass = factor(rep(c("Path1",
   "Path2",
   "Path3"),
   c(10, 4, 6))))
rownames(annotationRow) = paste("Gene", seq(20), sep = "")</p>
<p># Display row and color annotations
pheatmap(test, annotationCol = annotationCol)
pheatmap(test, annotationCol = annotationCol, annotationLegend = FALSE)
pheatmap(test, annotationCol = annotationCol, annotationRow = annotationRow)</p>
<p># Specify colors
ann_colors = list(Time = c("white", "firebrick"),
    CellType = c(CT1 = "#1B9E77", CT2 = "#D95F02"),
    GeneClass = c(Path1 = "#7570B3", Path2 = "#E7298A", Path3 = "#66A61E"))</p>
<p>pheatmap(test, annotationCol = annotationCol, annotationColors = ann_colors,
    main = "Title")
pheatmap(test, annotationCol = annotationCol, annotationRow = annotationRow,
    annotationColors = ann_colors)
pheatmap(test, annotationCol = annotationCol,
    annotationColors = ann_colors[2])</p>
<p># Gaps in heatmaps
pheatmap(test, annotationCol = annotationCol, clusterRows = FALSE,
    gapsRow = c(10, 14))
pheatmap(test, annotationCol = annotationCol, clusterRows = FALSE,
    gapsRow = c(10, 14), cutreeCol = 2)</p>
<p># Show custom strings as row/col names
labelsRow = c("", "", "", "", "", "", "", "", "", "", "", "", "", "", "",
"", "", "Il10", "Il15", "Il1b")</p>
<p>pheatmap(test, annotationCol = annotationCol, labelsRow = labelsRow)</p>
<p># Specifying clustering from distance matrix
drows = stats::dist(test, method = "minkowski")
dcols = stats::dist(t(test), method = "minkowski")
pheatmap(test,
    clusteringDistanceRows = drows,
    clusteringDistanceCols = dcols)</p>
<p># Modify ordering of the clusters using clustering callback option
callback = function(hc, mat) 
    sv = svd(t(mat))$v[, 1]
    dend = reorder(as.dendrogram(hc), wts = sv)
    as.hclust(dend)</p>
<p>pheatmap(test, clusteringCallback = callback)</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


