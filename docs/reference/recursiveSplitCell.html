<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Recursive cell splitting — recursiveSplitCell • celda</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Recursive cell splitting — recursiveSplitCell"><meta property="og:description" content="Uses the celda_C model to cluster cells into
 population for range of possible K's. The cell population labels of the
 previous &quot;K-1&quot; model are used as the initial values in the current model
 with K cell populations. The best split of an existing cell population is
 found to create the K-th cluster. This procedure is much faster than
 randomly initializing each model with a different K. If module labels for
 each feature are given in 'yInit', the celda_CG model will be used to
 split cell populations based on those modules instead of individual
 features. Module labels will also be updated during sampling and thus
 may end up slightly different than yInit."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.18.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://www.camplab.net/celda" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/campbio/celda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recursive cell splitting</h1>
    <small class="dont-index">Source: <a href="https://github.com/campbio/celda/blob/HEAD/R/recursiveSplit.R" class="external-link"><code>R/recursiveSplit.R</code></a></small>
    <div class="hidden name"><code>recursiveSplitCell.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses the <a href="celda_C.html">celda_C</a> model to cluster cells into
 population for range of possible K's. The cell population labels of the
 previous "K-1" model are used as the initial values in the current model
 with K cell populations. The best split of an existing cell population is
 found to create the K-th cluster. This procedure is much faster than
 randomly initializing each model with a different K. If module labels for
 each feature are given in 'yInit', the <a href="celda_CG.html">celda_CG</a> model will be used to
 split cell populations based on those modules instead of individual
 features. Module labels will also be updated during sampling and thus
 may end up slightly different than <code>yInit</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">recursiveSplitCell</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialK <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  maxK <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  tempL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  minCell <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  doResampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numResample <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SingleCellExperiment</span></span>
<span><span class="fu">recursiveSplitCell</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialK <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  maxK <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  tempL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  minCell <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  doResampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numResample <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for matrix</span></span>
<span><span class="fu">recursiveSplitCell</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  altExpName <span class="op">=</span> <span class="st">"featureSubset"</span>,</span>
<span>  sampleLabel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialK <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  maxK <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  tempL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yInit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  minCell <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  reorder <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  doResampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numResample <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  logfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A numeric <a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a> of counts or a
<a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a>
with the matrix located in the assay slot under <code>useAssay</code>.
Rows represent features and columns represent cells.</p></dd>


<dt>useAssay</dt>
<dd><p>A string specifying the name of the
<a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a>
slot to use. Default "counts".</p></dd>


<dt>altExpName</dt>
<dd><p>The name for the <a href="https://rdrr.io/pkg/SingleCellExperiment/man/altExps.html" class="external-link">altExp</a> slot
to use. Default "featureSubset".</p></dd>


<dt>sampleLabel</dt>
<dd><p>Vector or factor. Denotes the sample label for each cell
(column) in the count matrix.</p></dd>


<dt>initialK</dt>
<dd><p>Integer. Initial number of cell populations to try.
Default <code>5</code>.</p></dd>


<dt>maxK</dt>
<dd><p>Integer. Maximum number of cell populations to try.
Default <code>25</code>.</p></dd>


<dt>tempL</dt>
<dd><p>Integer. Number of temporary modules to identify and use in cell
splitting. Only used if <code>yInit = NULL</code>. Collapsing features to a
relatively smaller number of modules will increase the speed of clustering
and tend to produce better cell populations. This number should be larger
than the number of true modules expected in the dataset. Default
<code>NULL.</code></p></dd>


<dt>yInit</dt>
<dd><p>Integer vector. Module labels for features. Cells will be
clustered using the <a href="celda_CG.html">celda_CG</a> model based on the modules specified in
<code>yInit</code> rather than the counts of individual features. While the
features will be initialized to the module labels in <code>yInit</code>, the
labels will be allowed to move within each new model with a different K.</p></dd>


<dt>alpha</dt>
<dd><p>Numeric. Concentration parameter for Theta. Adds a pseudocount
to each cell population in each sample. Default <code>1</code>.</p></dd>


<dt>beta</dt>
<dd><p>Numeric. Concentration parameter for Phi. Adds a pseudocount to
each feature in each cell (if <code>yInit</code> is NULL) or to each module in
each cell population (if <code>yInit</code> is set). Default <code>1</code>.</p></dd>


<dt>delta</dt>
<dd><p>Numeric. Concentration parameter for Psi. Adds a pseudocount
to each feature in each module. Only used if <code>yInit</code> is set. Default 1.</p></dd>


<dt>gamma</dt>
<dd><p>Numeric. Concentration parameter for Eta. Adds a pseudocount
to the number of features in each module. Only used if <code>yInit</code> is set.
Default 1.</p></dd>


<dt>minCell</dt>
<dd><p>Integer. Only attempt to split cell populations with at
least this many cells.</p></dd>


<dt>reorder</dt>
<dd><p>Logical. Whether to reorder cell populations using
hierarchical clustering after each model has been created. If FALSE, cell
populations numbers will correspond to the split which created the cell
populations (i.e. 'K15' was created at split 15, 'K16' was created at split
16, etc.). Default TRUE.</p></dd>


<dt>seed</dt>
<dd><p>Integer. Passed to <a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a>. For reproducibility,
a default value of 12345 is used. If NULL, no calls to
<a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a> are made.</p></dd>


<dt>perplexity</dt>
<dd><p>Logical. Whether to calculate perplexity for each model.
If FALSE, then perplexity can be calculated later with
<a href="resamplePerplexity.html">resamplePerplexity</a>. Default TRUE.</p></dd>


<dt>doResampling</dt>
<dd><p>Boolean. If <code>TRUE</code>, then each cell in the counts
matrix will be resampled according to a multinomial distribution to introduce
noise before calculating perplexity. Default <code>FALSE</code>.</p></dd>


<dt>numResample</dt>
<dd><p>Integer. The number of times to resample the counts matrix
for evaluating perplexity if <code>doResampling</code> is set to <code>TRUE</code>.
Default <code>5</code>.</p></dd>


<dt>logfile</dt>
<dd><p>Character. Messages will be redirected to a file named
"logfile". If NULL, messages will be printed to stdout.  Default NULL.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. Whether to print log messages. Default TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a> object. Function
 parameter settings and celda model results are stored in the</p>
<p></p>
<p>metadata</p>
<p></p>
<p><code>"celda_grid_search"</code> slot. The models in
 the list will be of class <code>celda_C</code> if <code>yInit = NULL</code> or</p>
<p></p>
<p><code>celda_CG</code> if <code>zInit</code> is set.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="recursiveSplitModule.html">recursiveSplitModule</a> for recursive splitting of feature
 modules.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sceCeldaCG</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Create models that range from K = 3 to K = 7 by recursively splitting</span></span></span>
<span class="r-in"><span><span class="co">## cell populations into two to produce \link{celda_C} cell clustering models</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">recursiveSplitCell</span><span class="op">(</span><span class="va">sceCeldaCG</span>, initialK <span class="op">=</span> <span class="fl">3</span>, maxK <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive cell population splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Initializing with 3 populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Current cell population 4 | logLik: -1225755.01101897</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Current cell population 5 | logLik: -1213677.60126784</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Current cell population 6 | logLik: -1213903.59449854</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Current cell population 7 | logLik: -1214081.54311397</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive cell population splitting. Total time: 0.3127432 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, first identify features modules using</span></span></span>
<span class="r-in"><span><span class="co">## \link{recursiveSplitModule}</span></span></span>
<span class="r-in"><span><span class="va">moduleSplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="recursiveSplitModule.html">recursiveSplitModule</a></span><span class="op">(</span><span class="va">sceCeldaCG</span>, initialL <span class="op">=</span> <span class="fl">3</span>, maxL <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive module splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:32 2024 .. Collapsing to 100 temporary cell populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:34 2024 .. Initializing with 3 modules</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 4 | logLik: -1241379.90928455</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 5 | logLik: -1235212.7977535</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 6 | logLik: -1232789.9817561</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 7 | logLik: -1227246.66090571</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 8 | logLik: -1223898.757694</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 9 | logLik: -1221848.26936098</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 10 | logLik: -1220147.96681948</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 11 | logLik: -1220818.37022325</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 12 | logLik: -1221489.07685946</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:35 2024 .. Created module 13 | logLik: -1222032.53497571</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:36 2024 .. Created module 14 | logLik: -1222712.17543857</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:36 2024 .. Created module 15 | logLik: -1223268.97596756</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:36 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive module splitting. Total time: 3.285614 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span><span class="fu"><a href="plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">moduleSplit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recursiveSplitCell-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">moduleSplitSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">moduleSplit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Then use module labels for initialization in \link{recursiveSplitCell} to</span></span></span>
<span class="r-in"><span><span class="co">## produce \link{celda_CG} bi-clustering models</span></span></span>
<span class="r-in"><span><span class="va">cellSplit</span> <span class="op">&lt;-</span> <span class="fu">recursiveSplitCell</span><span class="op">(</span><span class="va">sceCeldaCG</span>,</span></span>
<span class="r-in"><span>  initialK <span class="op">=</span> <span class="fl">3</span>, maxK <span class="op">=</span> <span class="fl">7</span>, yInit <span class="op">=</span> <span class="fu"><a href="celdaModules.html">celdaModules</a></span><span class="op">(</span><span class="va">moduleSplitSelect</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive cell population splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:36 2024 .. Collapsing to 10 modules</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:36 2024 .. Initializing with 3 populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:37 2024 .. Current cell population 4 | logLik: -1225286.49558716</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:37 2024 .. Current cell population 5 | logLik: -1212955.15575681</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:37 2024 .. Current cell population 6 | logLik: -1212982.74290613</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:37 2024 .. Current cell population 7 | logLik: -1213005.40337891</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:37 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive cell population splitting. Total time: 1.227239 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span><span class="fu"><a href="plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">cellSplit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recursiveSplitCell-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">cellSplit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">celdaCGSim</span>, <span class="va">celdaCSim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Create models that range from K = 3 to K = 7 by recursively splitting</span></span></span>
<span class="r-in"><span><span class="co">## cell populations into two to produce \link{celda_C} cell clustering models</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">recursiveSplitCell</span><span class="op">(</span><span class="va">celdaCSim</span><span class="op">$</span><span class="va">counts</span>, initialK <span class="op">=</span> <span class="fl">3</span>, maxK <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive cell population splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Initializing with 3 populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Current cell population 4 | logLik: -1341630.1679001</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Current cell population 5 | logLik: -1327506.91718317</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Current cell population 6 | logLik: -1315227.54586167</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Current cell population 7 | logLik: -1304393.65802293</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:38 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive cell population splitting. Total time: 0.2604418 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, first identify features modules using</span></span></span>
<span class="r-in"><span><span class="co">## \link{recursiveSplitModule}</span></span></span>
<span class="r-in"><span><span class="va">moduleSplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="recursiveSplitModule.html">recursiveSplitModule</a></span><span class="op">(</span><span class="va">celdaCGSim</span><span class="op">$</span><span class="va">counts</span>,</span></span>
<span class="r-in"><span>  initialL <span class="op">=</span> <span class="fl">3</span>, maxL <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive module splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:39 2024 .. Collapsing to 100 temporary cell populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Initializing with 3 modules</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 4 | logLik: -1243396.62348886</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 5 | logLik: -1237610.11790137</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 6 | logLik: -1232128.87013396</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 7 | logLik: -1227611.8250329</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 8 | logLik: -1225618.06184004</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:40 2024 .. Created module 9 | logLik: -1223967.77531912</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 10 | logLik: -1222801.11395987</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 11 | logLik: -1223402.66903597</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 12 | logLik: -1224026.19892208</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 13 | logLik: -1224675.63005464</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 14 | logLik: -1225317.91966369</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Created module 15 | logLik: -1225971.50555157</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:41 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive module splitting. Total time: 2.560257 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span><span class="fu"><a href="plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">moduleSplit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recursiveSplitCell-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">moduleSplitSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">moduleSplit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Then use module labels for initialization in \link{recursiveSplitCell} to</span></span></span>
<span class="r-in"><span><span class="co">## produce \link{celda_CG} bi-clustering models</span></span></span>
<span class="r-in"><span><span class="va">cellSplit</span> <span class="op">&lt;-</span> <span class="fu">recursiveSplitCell</span><span class="op">(</span><span class="va">celdaCGSim</span><span class="op">$</span><span class="va">counts</span>,</span></span>
<span class="r-in"><span>  initialK <span class="op">=</span> <span class="fl">3</span>, maxK <span class="op">=</span> <span class="fl">7</span>, yInit <span class="op">=</span> <span class="fu"><a href="celdaModules.html">celdaModules</a></span><span class="op">(</span><span class="va">moduleSplitSelect</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting recursive cell population splitting.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:42 2024 .. Collapsing to 10 modules</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:42 2024 .. Initializing with 3 populations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:44 2024 .. Current cell population 4 | logLik: -1227944.5458832</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:44 2024 .. Current cell population 5 | logLik: -1215605.08613503</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:44 2024 .. Current cell population 6 | logLik: -1215627.62281773</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:44 2024 .. Current cell population 7 | logLik: -1215651.32538066</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Tue Apr  2 18:56:44 2024 .. Calculating perplexity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed recursive cell population splitting. Total time: 2.064909 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==================================================</span>
<span class="r-in"><span><span class="fu"><a href="plotGridSearchPerplexity.html">plotGridSearchPerplexity</a></span><span class="op">(</span><span class="va">cellSplit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="recursiveSplitCell-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetCeldaList.html">subsetCeldaList</a></span><span class="op">(</span><span class="va">cellSplit</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">5</span>, L <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

